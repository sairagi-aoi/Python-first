# 健康ログプロジェクト 🏥🐱

飼い主（自分）と猫（よつば）の体調を記録し、相関関係を分析するアプリケーション

## 📖 プロジェクト概要

### 目的
日々の体調データを記録することで、飼い主と猫の健康状態に相関関係があるかを調べる。
「飼い主の体調が悪いと、猫も元気がなくなる？」という仮説を検証するためのデータ収集ツール。

### 背景
- 自分の体調が悪い日に、猫のよつばも元気がないように感じた
- その相関を科学的に確認したい
- プログラミングの学習も兼ねて、実用的なアプリを作成

## 🎯 機能

### 現在実装されている機能

1. **体調データの入力**
   - 飼い主の名前（デフォルト: 佐藤 or 砂糖）
   - 猫の名前（デフォルト: よつば or Yotsuba）
   - 飼い主の体調（5段階評価）
   - 猫の体調（5段階評価）

2. **詳細情報の記録（体調不良時のみ）**
   - 症状の種類（精神面/身体面/両方）
   - 発症時期（いつから）
   - 原因の推測
   - 猫の様子詳細（ぐったり、食欲、遊び、水分摂取、トイレ）

3. **データ保存**
   - CSV形式で保存（`health_cat_log.csv`）
   - テキスト形式でも保存（`health_cat_log.txt`）
   - タイムスタンプ自動記録

## 📁 ファイル構成

### メインファイル

#### `taityoukakinaosi.py` - 初版
最初に作成したバージョン。基本機能を実装。

**実行方法**:
```bash
python taityoukakinaosi.py
```

#### `output/taityousoukan.py` - 改良版
入力バリデーションを強化し、コードを整理したバージョン。

**実行方法**:
```bash
python output/taityousoukan.py
```

**改良点**:
- ヘルパー関数の追加（`ask_choice()`, `ask_nonempty()`）
- 入力バリデーションの強化
- コードの可読性向上
- エラーハンドリングの改善

### ユーティリティモジュール

#### `src/io_csv.py`
CSV操作を行う再利用可能なモジュール。

**機能**:
```python
def append_csv(path: str | Path, row: dict, fieldnames: list[str]):
    """
    CSVファイルに1行追加する
    - ファイルが存在しない場合は自動でヘッダーを作成
    - タイムスタンプを自動で追加
    - 親ディレクトリが存在しない場合は自動作成
    """
```

### データファイル

#### `health_cat_log.csv` - メインデータ
すべての体調記録が保存されるCSVファイル。

#### `health_cat_log.txt` - テキストログ
人間が読みやすい形式のテキストファイル。

## 📊 データ構造

### CSVファイルのカラム（全15列）

| カラム名 | 説明 | データ例 |
|---------|------|---------|
| `timestamp` | 記録日時 | 2025-10-26 14:30:00 |
| `owner` | 飼い主の名前 | 佐藤 / 砂糖 |
| `cat` | 猫の名前 | よつば / Yotsuba |
| `owner_condition` | 飼い主の体調 | 最悪/悪い/普通/良い/絶好調 |
| `cat_condition` | 猫の体調 | ぐったり/元気ない/普通/元気/走り回ってる |
| `owner_score` | 飼い主スコア | -2 〜 +2 |
| `cat_score` | 猫スコア | -2 〜 +2 |
| `condition_type` | 症状の種類 | 精神面/身体面/両方 |
| `condition_since` | 発症時期 | 昨日から/今朝から/etc |
| `condition_cause` | 原因 | 寝不足/ストレス/疲れた |
| `condition_yousu` | 猫の様子 | ぐったり/動かない/etc |
| `condition_eating` | 食欲 | 減った/変わらない/増えた |
| `condition_play` | 遊び | しない/少し/いつも通り |
| `condition_drink` | 水分摂取 | 減った/変わらない/増えた |
| `condition_toilet` | トイレ | 減った/変わらない/増えた |

### 体調スコアリング

#### 飼い主（OWNER_SCALE）
```python
OWNER_SCALE = {
    "最悪": -2,
    "悪い": -1,
    "普通": 0,
    "良い": 1,
    "絶好調": 2,
}
```

#### 猫（CAT_SCALE）
```python
CAT_SCALE = {
    "ぐったり": -2,
    "元気ない": -1,
    "普通": 0,
    "元気": 1,
    "走り回ってる": 2,
}
```

## 💻 使い方

### 1. 基本的な実行

```bash
# 改良版を実行（推奨）
python output/taityousoukan.py
```

### 2. 入力例

```
飼い主の名前（デフォルト: 佐藤）を入力: 佐藤
猫の名前（デフォルト: よつば）を入力: よつば

🧑 飼い主の体調は？
  最悪 / 悪い / 普通 / 良い / 絶好調
👉 悪い

🐱 よつばの体調は？
  ぐったり / 元気ない / 普通 / 元気 / 走り回ってる
👉 元気ない

--- 体調不良の詳細 ---

🔍 どんな不調？（精神面/身体面/両方）
👉 精神面

⏰ いつから？
👉 昨日から

💭 何が原因だと思いますか？
👉 寝不足

🐱 よつばの様子を詳しく教えてください
👉 いつもより動かない

🍽️ 食欲は？（減った/変わらない/増えた）
👉 減った

🎾 遊びは？（しない/少し/いつも通り）
👉 少し

💧 水分摂取は？（減った/変わらない/増えた）
👉 変わらない

🚽 トイレは？（減った/変わらない/増えた）
👉 変わらない

✅ データを保存しました
```

### 3. データの確認

```bash
# CSVファイルを確認
cat health_cat_log.csv

# または Excelで開く
# open health_cat_log.csv（Mac）
# start health_cat_log.csv（Windows）
```

## 📈 データ分析（今後の予定）

### 現在のデータ状況（2025-11-25時点）
- 記録数: 12エントリー
- 期間: 2025-10-26 〜 2025-11-19
- 飼い主の平均スコア: [計算予定]
- 猫の平均スコア: [計算予定]

### 今後実装予定の分析機能

1. **相関係数の計算**
   ```python
   # pandasを使った分析
   import pandas as pd
   df = pd.read_csv("health_cat_log.csv")
   correlation = df["owner_score"].corr(df["cat_score"])
   print(f"相関係数: {correlation}")
   ```

2. **グラフ可視化**
   - 時系列グラフ（飼い主と猫の体調推移）
   - 散布図（相関関係の可視化）
   - ヒートマップ（曜日別の傾向）

3. **統計分析**
   - 平均スコアの計算
   - 体調不良の頻度分析
   - 原因別の集計

## 🔧 技術スタック

- **言語**: Python 3.10+
- **標準ライブラリ**:
  - `csv` - CSV操作
  - `pathlib` - パス操作
  - `datetime` - タイムスタンプ生成
- **将来的に追加予定**:
  - `pandas` - データ分析
  - `matplotlib` - グラフ描画
  - `numpy` - 数値計算

## 🐛 既知の問題

### データ品質の問題
1. **タイムスタンプ欠落**
   - `health_cat_log.csv`の9〜11行目でタイムスタンプが空
   - 原因: [調査予定]
   - 対策: [実装予定]

2. **データ入力ミス**
   - 8行目で飼い主と猫の名前が入れ替わっている可能性
   - 対策: 入力確認機能の追加

### コードの問題
1. **タイポ**
   - `output/taityousoukan.py:100` - "timstamp" → "timestamp"
   - `output/taityousoukan.py:108` - "sine" → "since"

## 📝 バージョン履歴

### v1.0 - `taityoukakinaosi.py`
- 初版リリース
- 基本的な入力・保存機能
- CSV/TXTへの出力

**課題**:
- 入力バリデーションが不十分
- コードが長く読みにくい
- 重複コードが多い

### v2.0 - `output/taityousoukan.py`
- ヘルパー関数の追加
- 入力バリデーション強化
- コードの整理とリファクタリング
- エラーハンドリング改善

**改良点**:
- `ask_choice()` - 選択肢入力
- `ask_nonempty()` - 空文字チェック
- より詳細な猫の様子記録
- スマートなデータ保存（不調時のみ詳細記録）

**残課題**:
- タイポの修正
- データ分析機能の追加
- グラフ可視化

## 🚀 今後の展開

### Phase 1: データクリーニング ✅
- [ ] タイムスタンプの欠落を修正
- [ ] タイポの修正（timstamp, sine）
- [ ] データの整合性チェック

### Phase 2: 分析機能の追加 📊
- [ ] pandasでデータ読み込み
- [ ] 相関係数の計算
- [ ] 基本統計量の算出
- [ ] 分析結果を表示する機能

### Phase 3: 可視化 📈
- [ ] matplotlibで時系列グラフ
- [ ] 散布図で相関を可視化
- [ ] 週別・月別の集計グラフ
- [ ] レポート自動生成

### Phase 4: UI改善 💻
- [ ] GUIアプリ化（Tkinter）
- [ ] データ編集機能
- [ ] エクスポート機能（PDF等）
- [ ] Webアプリ化（Flask/FastAPI）

### Phase 5: 高度な分析 🔬
- [ ] 機械学習で予測モデル作成
- [ ] 異常検知
- [ ] 長期トレンド分析

## 📚 学んだこと

このプロジェクトを通じて習得したスキル:
- ✅ CSV操作（DictWriter）
- ✅ ファイルI/O
- ✅ 入力バリデーション
- ✅ エラーハンドリング
- ✅ 関数の分割と再利用
- ✅ モジュール化
- ✅ テストコード作成
- ✅ Git によるバージョン管理

## 💡 参考リンク

- [Python公式ドキュメント - csv](https://docs.python.org/ja/3/library/csv.html)
- [Python公式ドキュメント - pathlib](https://docs.python.org/ja/3/library/pathlib.html)
- [pandas公式ドキュメント](https://pandas.pydata.org/docs/)
- [matplotlib公式ドキュメント](https://matplotlib.org/stable/index.html)

---

**健康管理もプログラミングも、継続が大切です 💪🐱**
